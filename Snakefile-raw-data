
# Obtain data 
include: "retrieve_human_genome.smk" 
include: "retrieve_protein_coding_sequences.smk" 
include: non coding rna # check how implement the RNAcentral web query

rule download_rnacentral_bed:       #maybe this one on a external script 
    output:
        "data/raw/rnacentral_GRCh38_coordinates.bed"
    shell:
        """
        wget -P data/raw ftp://ftp.ebi.ac.uk/pub/databases/RNAcentral/releases/22.0/genome_coordinates/bed/homo_sapiens.GRCh38.bed.gz &&
        gunzip -c data/raw/homo_sapiens.GRCh38.bed.gz > {output} &&
        rm data/raw/homo_sapiens.GRCh38.bed.gz
        """

#rule download_raw_sequences: 

#    output: 
#        "data/raw/rnacentral-lncrna.fasta"
#        "data/raw/rnacentral-short-ncrna.fasta"
#        "data/raw/rnacentral-pre-mirna.fasta" 


# Convert downloaded fasta files to csv for easier data retrieval 
rule fasta_to_csv:
    input: 
        lncrna="data/raw/rnacentral-lncrna.fasta",
        short_ncrna="data/raw/rnacentral-short-ncrna.fasta",
        pre_mirna="data/raw/rnacentral-pre-mirna.fasta" 
    
    output: 
        lncrna_csv="data/raw/rnacentral-lncrna-seq.csv", 
        short_ncrna_csv="data/raw/rnacentral-short-ncrna-seq.csv",
        pre_mirna_csv="data/raw/rnacentral-pre-mirna-seq.csv" 
        
    shell: 
        "fasta_formatter -i {input} -o {output} -t" 


